# Linuxのインストールとパッケージ管理

## ハードディスクのレイアウト設計
### Linuxインストールに必要なパーティション
- パーティション：ハードディスクやSSDを論理的に分けるもの
- Linuxのインストールには最低次の二つのパーティションが必要
    - ルートパーティション
    - スワップ領域
- なぜ分ける？
    - ディスク障害時のリスク分散
    - 障害時にスムーズに復旧させるため
- 下記ディレクトリは、独立したパーティションに割り当てるのが一般的
    - /home: 一般ユーザごとのディレクトリ
    - /var: 各種ログファイルやメールスプールなど、更新頻度の高いファイルの置き場
        - メールスプール：受信用メールサーバ上でメールアドレス宛に届いたメールが溜まるところで，郵便局の私書箱のような場所
        - 膨大なログがルートファイルシステムを食い潰さないように、別パーティションに区分することも
    - /usr: プログラムやライブラリ、ドキュメントの置き場
        - 別パーティションにおくとプログラムが正常動作しない場合もある
        - NFSを使ってコマンドやプログラムを共有する場合、/usrを読み込み専用でマウントするとセキュリティ高めれる
    - /boot: ディスクの先頭パーティションとして区分するのが良いシステムもある。例えばRAIDを利用する時。
        - RAID(Redundant Arrays of Inexpensive Disks): 複数のディスクをひとつのように認識・表示させる技術
            - ディスク故障時にもデータ復旧・アクセスを可能にする安全性の向上や、複数HDDへの分散書き込みによるデータ保存の高速化など、RAIDモード毎に特長があり、用途に合わせて様々なストレージ構築が可能
                - ビジネスシーンなど高い信頼性が必要な場合に利用される
    - EFIシステムパーティション(ESP)：ブートローダやデバイスドライバなどの置き場
        - UEFIを使ったシステムでは必要
            - UEFI: コンピュータ内の各装置を制御するファームウェアとOSの間の通信仕様を定めた標準規格の一つ
                - BIOSに代わるもの
                - UEFI対応ファームウェアを指してUEFIと呼ぶことも
    - スワップ領域: 物理メモリの1~2倍程度割り当てる
    - /(root): 上記以外はルートファイルシステムになる
        - ファイルシステム障害時に復旧しやすくするため、できるだけ小さくしたほうがいい

### パーティションのレイアウト設計
- 設計時に考慮すべきこと
    - 用途が異なるディレクトリを別パーティションに配置する
    - ディスク容量の割り当て配分
    - バックアップ方法
- LVM: 論理ボリューム管理
    - パーティション上にそのままファイルシステムを作成するのではなく、ボリュームグループという仮想ディスクを作成し、その上に仮想的なパーティションを作成する仕組み
        - ディスクの取り扱いやバックアップなどがより柔軟にできる

## ブートローダのインストール
- ブートローダ：ストレージからOSを読み込んで起動するプログラム
- GRUB(GRand Unified Bootloader): Linuxの代表的なブートローダ
    - 特徴
        - 多数のファイルシステムを認識可能
        - シェル機能を持つので、コマンドによる高度な管理が可能
    - how to install: `grub-install`コマンド
        - Ex. /dev/sdaのMBR領域にGRUBをインストールする場合
            - `# grub-install /dev/sda`
            - MBR(master boot record): 起動ドライブの最初のセクタ
                - 起動ドライブ：コンピュータの起動時や再起動時に、OSを読み出して起動するよう指定されたストレージ
                    - 複数の起動可能な装置がある場合はBIOSやUEFIで優先順位を指定する

## 共有ライブラリ管理
- 静的ライブラリ：プログラム作成時にその実行ファイル内に読み込まれるライブラリ
- 共有ライブラリ：プログラムの実行時にロードされ、複数のプログラム間で共有されるライブラリ
    - ダイナミックリンクによって呼び出されるライブラリ、とも言える
    - lib~ .so~ と命名されがち
    - /libや/usr/libに置かれがち

### スタティックリンク＆ダイナミックリンク
- スタティックリンク: コンパイル時点で、コンパイラがライブラリを実行ファイル内に埋め込む
    - よく使われるライブラリは、様々な実行ファイル内に含まれて重複してしまう
- ダイナミックリンク: 実行ファイルへライブラリを埋め込むことはせず、実行時にライブラリの機能を呼び出す方法

### 必要な共有ライブラリの確認
- `ldd`コマンド：ある実行ファイルが必要とする共有ライブラリを調べられる
    - Ex. `$ ldd /bin/cat`
- プログラム実行時：ld.soリンカおよびローダが必要な共有ライブラリを検索、ロードする
    - 検索の順序
    - 環境変数`LD_LIBRARY_PATH`
    - `/etc/ld.so.cache`
    - `/lib`, `/usr/lib`
    - `/etc/ld.so.conf`に検索対象にしたい共有ライブラリのリストを記述しておく(`lib`, `/usr/lib`内のものはデフォの検索対象なので不要)
    - `ldconfig`コマンド: ロード結果のキャッシュファイル(バイナリ形式)を再構築する

## Debianのパッケージ管理
### 
- 

### 
- 


## 
### 
- 

### 
- 


## 
### 
- 

### 
- 


## 
### 
- 

### 
- 

