# CH12 セキュリティ

## 12.1 ホストレベルのセキュリティ
セキュリティを高める方法
- 外部からの侵入に対するセキュリティを高める
    - 必要なソフトウェアのみインストールし、不要なサービスを起動しない
    - ホストレベルの適切なアクセス制御を行う
    - パケットフィルタリングによりアクセスを制限する
    - セキュリティ情報の確認を頻繁に行い、必要があれば素早く対策を実施する
- 内部からの侵入に対するセキュリティを高める
    - 適切なユーザーパスワード管理を行う
    - スーパーユーザー権限で動作するプログラムを最小限にし、定期的にチェックを行う

### 12.1.1 スーパーサーバの設定と管理
- `デーモン`
    - ネットワークを通じてサービスを提供しているサーバ
    - 常時メモリ上に待機しており、クライアントからの要求を監視する
        - 常時リソースを消費する→デーモン数が多くなると消費するシステムリソースも増える
        - リソース：メモリ、CPU、ディスク領域などのコンピュータシステムの動作に必要となる要素のこと
- `スーパーサーバ`
    - デーモンのリソース消費を管理するために開発されたもの
        - ex. inetd, `xinetd`(大抵、こっち採用されてる)
    - メリット
        - 他のサーバプログラムに変わってサービス要求を監視し、接続が確立した時点で本来のサーバプログラムに要求を引き渡す
        - 必要な時だけここのサーバプログラムを起動することで、メモリなどのリソースを効率的に使える
        - TCP Wrapperと組み合わせることで、アクセス制御を集中的に管理できる
    - デメリット
        - 応答が遅れる
            - すぐ応答する必要があるサーバは、スーパーサーバ経由でなくサーバプログラム自身でサービス要求を監視するべき（`スタンドアローン`）
                - ex. Webサーバ、メールサーバなど
    - スーパーサーバ経由の接続に適したサーバ
            - 接続の頻度が高くないサーバ
                - ex. FTP(File Transfer Protocol)サーバ、Telnetサーバ(ネットワーク越しにCLIに接続するやつ)など

### 12.1.2 xinetdの設定
- `/etc/xinetd.conf`ファイル：全体的な設定
- `/etc/xinetd.d`以下：サービスごとの設定

### 12.1.3 TCP Wrapperによるアクセス制御
- `TCP Wrapper`：ネットワークサービスのアクセス制御を集中的に行うもの
    - 設定ファイル：`/etc/hosts.allow`, `/etc/hosts.deny`
        - どちらにも記述がないホストはアクセス許可される
    - tcpd（デーモン）：telnetdやftpdなどのサーバプログラムに代わってサービス要求を受け取った後、設定に基づいてチェックを行い、接続が許可された場合はそれぞれのサーバプログラムに処理を引き渡す
        - .allowに書いてある→OK
        - .allowに書いてない→.denyに書いてない→OK
        - それ以外はNG

`/etc/hosts.allow`ファイルの記述例
```
sshd: .lpic.jp
ALL: 192.168.2.
```

重要：.allowが先にチェックされる。.allowで許可されたら、.denyは確認しない。

### 12.1.4 開いているポートの確認

### 12.1.5 SUIDが設定されているファイル

## 12.2 ユーザに対するセキュリティ管理

### 12.2.1 パスワード管理

### 12.2.2 ログインの禁止

### 12.2.3 ユーザの切り替え

### 12.2.4 sudo

### 12.2.5 システムリソースの制限

## 12.3 OpenSSH

### 12.3.1 SSHのインストールと設定

### 12.3.2 ホスト認証

### 12.3.3 公開鍵認証

### 12.3.4 SSHの活用

## 12.4 GnuPGによる暗号化

### 12.4.1 鍵ペアの作成と失効証明書の作成

### 12.4.2 共通鍵を使ったファイルの暗号化

### 12.4.3 公開鍵を使ったファイルの暗号化

